@startuml booking-data-model
!theme plain
title Booking System Data Model (ERD)

skinparam linetype ortho
skinparam roundcorner 5
skinparam class {
    BackgroundColor White
    BorderColor #333333
    ArrowColor #333333
}

' ==================
' ROOM DOMAIN
' ==================

entity "room" as room {
    * **id** : BIGINT <<PK>>
    --
    * name : VARCHAR(100)
    description : TEXT
    capacity : INT
    * room_type : ENUM
    hourly_rate : DECIMAL(10,2)
    * is_active : BOOLEAN
    metadata : JSON
    * created_at : DATETIME
    * updated_at : DATETIME
    --
    room_type: office | consultation
              | meeting | treatment
}

entity "timeslot" as timeslot {
    * **id** : BIGINT <<PK>>
    --
    * room_id : BIGINT <<FK>>
    * start_time : DATETIME
    * end_time : DATETIME
    * is_available : BOOLEAN
    price : DECIMAL(10,2)
    max_bookings : INT
    * created_at : DATETIME
    --
    Indexed: room_id + start_time + end_time
    Indexed: is_available + start_time
}

' ==================
' BOOKING DOMAIN
' ==================

entity "booking" as booking {
    * **id** : BIGINT <<PK>>
    --
    * user_id : BIGINT <<FK>>
    * timeslot_id : BIGINT <<FK>>
    * room_id : BIGINT <<FK>>
    * status : ENUM
    booking_type : VARCHAR(50)
    * price : DECIMAL(10,2)
    * payment_status : ENUM
    payment_id : VARCHAR(255)
    notes : TEXT
    metadata : JSON
    * created_at : DATETIME
    * updated_at : DATETIME
    cancelled_at : DATETIME
    --
    status: pending | confirmed
           | cancelled | completed | no_show
    payment_status: pending | paid | refunded
}

entity "booking_reminder" as booking_reminder {
    * **id** : BIGINT <<PK>>
    --
    * booking_id : BIGINT <<FK>>
    * reminder_type : ENUM
    * scheduled_at : DATETIME
    sent_at : DATETIME
    * status : ENUM
    * created_at : DATETIME
    --
    reminder_type: email_24h | email_1h | sms
    status: pending | sent | cancelled
}

' ==================
' RELATIONSHIPS
' ==================

' Room relationships
room ||--o{ timeslot : "has"
room ||--o{ booking : "booked for"

' Timeslot relationships
timeslot ||--o{ booking : "reserved in"

' Booking relationships
booking ||--o{ booking_reminder : "scheduled"

' ==================
' EXTERNAL RELATIONSHIPS
' ==================

entity "user" as user #LightGray {
    * **id** : BIGINT <<PK>>
    --
    (external reference)
}

user ||--o{ booking : "makes"

' ==================
' NOTES
' ==================

note right of room
    **Room entity:**
    Physical or virtual space
    for appointments.
    hourly_rate used for
    timeslot price calculation.
end note

note right of timeslot
    **Timeslot entity:**
    Discrete time periods
    available for booking.
    Auto-generated by admin
    with working hours config.
end note

note right of booking
    **Booking entity:**
    User reservation for
    specific timeslot.
    Tracks payment status
    and booking lifecycle.
end note

note bottom of booking_reminder
    **Reminder system:**
    Automated notifications
    sent before appointments.
    Can be email or SMS.
end note

@enduml
